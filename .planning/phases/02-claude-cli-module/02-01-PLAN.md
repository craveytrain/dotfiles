---
phase: 02-claude-cli-module
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - modules/claude/config.yml
  - modules/claude/README.md
  - modules/claude/files/.claude/settings.json
  - modules/claude/files/.claude/agents/
  - modules/claude/files/.claude/commands/
  - modules/claude/files/.claude/get-shit-done/
autonomous: true

must_haves:
  truths:
    - "Claude module exists with correct structure"
    - "Syncable settings.json uses portable paths"
    - "Agents and commands directories populated"
    - "GSD workflow framework included"
  artifacts:
    - path: "modules/claude/config.yml"
      provides: "Module configuration for ansible-role-dotmodules"
      contains: "homebrew_casks"
    - path: "modules/claude/README.md"
      provides: "Module documentation with auth instructions"
      min_lines: 50
    - path: "modules/claude/files/.claude/settings.json"
      provides: "Portable user settings"
    - path: "modules/claude/files/.claude/agents/"
      provides: "Custom agent definitions"
    - path: "modules/claude/files/.claude/commands/"
      provides: "Custom slash commands"
    - path: "modules/claude/files/.claude/get-shit-done/"
      provides: "GSD workflow framework"
  key_links:
    - from: "modules/claude/config.yml"
      to: "stow_dirs"
      via: "stow_dirs directive"
      pattern: "stow_dirs.*claude"
---

<objective>
Create Claude CLI module with syncable configuration files

Purpose: Establish the module structure and populate it with configuration files that should be synchronized across machines (agents, commands, GSD workflow, portable settings).

Output: Complete modules/claude/ directory ready for deployment
</objective>

<execution_context>
@/Users/mcravey/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mcravey/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-claude-cli-module/02-RESEARCH.md
@modules/ghostty/config.yml
@modules/ghostty/README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create module structure and config.yml</name>
  <files>
    modules/claude/config.yml
    modules/claude/files/.claude/.gitkeep
  </files>
  <action>
Create the Claude module directory structure following the ghostty module pattern:

1. Create `modules/claude/config.yml` with:
   - `homebrew_casks: [claude-code]` for installation
   - `stow_dirs: [claude]` for symlink deployment

2. Create the nested file structure:
   - `modules/claude/files/.claude/` directory

Use the exact format from modules/ghostty/config.yml as the template.
  </action>
  <verify>
    - `ls modules/claude/config.yml` shows file exists
    - `cat modules/claude/config.yml` shows homebrew_casks and stow_dirs
    - `ls -d modules/claude/files/.claude` shows directory exists
  </verify>
  <done>Module config.yml exists with homebrew_casks and stow_dirs directives, files/.claude directory created</done>
</task>

<task type="auto">
  <name>Task 2: Populate syncable configuration files</name>
  <files>
    modules/claude/files/.claude/settings.json
    modules/claude/files/.claude/agents/
    modules/claude/files/.claude/commands/
    modules/claude/files/.claude/get-shit-done/
  </files>
  <action>
Copy syncable files from ~/.claude/ to the module. IMPORTANT: Only copy files identified as safe to sync in the research.

1. **settings.json** - Create a PORTABLE version:
   ```json
   {
     "statusLine": {
       "type": "static",
       "content": "Claude Code"
     }
   }
   ```
   NOTE: Do NOT copy the existing settings.json as it has hardcoded paths. Create a clean portable one.

2. **agents/** - Copy entire directory:
   ```bash
   cp -r ~/.claude/agents/ modules/claude/files/.claude/agents/
   ```

3. **commands/** - Copy entire directory:
   ```bash
   cp -r ~/.claude/commands/ modules/claude/files/.claude/commands/
   ```

4. **get-shit-done/** - Copy entire directory:
   ```bash
   cp -r ~/.claude/get-shit-done/ modules/claude/files/.claude/get-shit-done/
   ```

DO NOT copy (machine-specific):
- settings.local.json
- history.jsonl
- stats-cache.json
- projects/
- cache/
- debug/
- file-history/
- todos/
- plans/
- hooks/ (has hardcoded paths)
- ide/
- session-env/
- shell-snapshots/
  </action>
  <verify>
    - `ls modules/claude/files/.claude/settings.json` exists
    - `cat modules/claude/files/.claude/settings.json` shows portable statusLine config (no hardcoded paths)
    - `ls modules/claude/files/.claude/agents/*.md | wc -l` shows agent files copied
    - `ls modules/claude/files/.claude/commands/gsd/*.md | wc -l` shows command files copied
    - `ls modules/claude/files/.claude/get-shit-done/` shows workflows, templates, references
  </verify>
  <done>All syncable Claude configuration files copied to module with portable settings.json</done>
</task>

<task type="auto">
  <name>Task 3: Create module README</name>
  <files>modules/claude/README.md</files>
  <action>
Create comprehensive README following the ghostty module pattern. Include:

1. **Header** - Module name and description
2. **Core Features** - What gets synchronized (settings, agents, commands, GSD)
3. **Installation Components** - Files deployed and software installed
4. **Prerequisites** - What's needed (Homebrew)
5. **Deployment** - How to deploy the module
6. **Configuration** - How to edit and sync changes
7. **Post-Deployment Authentication** - CRITICAL: Document that user must run `claude` and authenticate after deployment (auth state is machine-specific)
8. **Files** - Directory structure
9. **What Is NOT Synced** - Important section explaining settings.local.json, hooks with paths, session data
10. **References** - Link to Claude Code documentation

Use modules/ghostty/README.md as structural template but adapt content for Claude.
  </action>
  <verify>
    - `ls modules/claude/README.md` exists
    - `grep -c "authentication" modules/claude/README.md` returns at least 1 (auth documented)
    - `grep -c "NOT Synced" modules/claude/README.md` returns 1 (exclusions documented)
    - `wc -l modules/claude/README.md` returns at least 80 lines
  </verify>
  <done>README.md created with deployment instructions, authentication guidance, and documented exclusions</done>
</task>

</tasks>

<verification>
Module structure verification:
- `tree modules/claude/` shows complete structure
- `cat modules/claude/config.yml` shows valid YAML with homebrew_casks and stow_dirs
- All agents, commands, and get-shit-done files present
- settings.json is portable (no machine-specific paths)
- README documents authentication requirement
</verification>

<success_criteria>
- modules/claude/ directory exists with config.yml, README.md, and files/
- config.yml contains homebrew_casks: [claude-code] and stow_dirs: [claude]
- files/.claude/ contains settings.json, agents/, commands/, get-shit-done/
- settings.json uses portable configuration (no hardcoded paths)
- README documents post-deployment authentication requirement
</success_criteria>

<output>
After completion, create `.planning/phases/02-claude-cli-module/02-01-SUMMARY.md`
</output>
